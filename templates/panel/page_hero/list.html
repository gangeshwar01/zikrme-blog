{% extends "panel/base.html" %}

{% block content %}
<div class="p-4 md:p-6 space-y-6">
  <!-- Header -->
  <div class="flex items-center justify-between">
    <div>
      <h1 class="text-2xl font-semibold text-slate-800">Page Hero Images</h1>
      <p class="text-slate-600">Manage hero images for different pages</p>
    </div>
    <div class="flex gap-2">
      <button onclick="document.getElementById('createForm').classList.toggle('hidden')" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700">
        <i class="ri-add-line"></i> Add Page Hero
      </button>
    </div>
  </div>

  <!-- Success/Error Messages -->
  {% if success_message %}
    <div class="bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg">
      {{ success_message }}
    </div>
  {% endif %}
  {% if error_message %}
    <div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg">
      {{ error_message }}
    </div>
  {% endif %}

  <!-- Create Form -->
  <div id="createForm" class="{% if error_message and not success_message %}block{% else %}hidden{% endif %} bg-white rounded-xl border border-slate-200 p-6">
    <h3 class="text-lg font-medium text-slate-800 mb-4">Create New Page Hero</h3>
    
    <form method="POST" action="{% url 'panel_page_hero_create' %}" enctype="multipart/form-data" class="space-y-4">
      {% csrf_token %}
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-2">Page <span class="text-red-500">*</span></label>
          {{ form.page }}
          {% if form.page.errors %}
            <p class="text-red-500 text-sm mt-1">{{ form.page.errors.0 }}</p>
          {% endif %}
        </div>
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-2">Image <span class="text-red-500">*</span></label>
          {{ form.image }}
          {% if form.image.errors %}
            <p class="text-red-500 text-sm mt-1">{{ form.image.errors.0 }}</p>
          {% endif %}
        </div>
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-2">Title</label>
          {{ form.title }}
          {% if form.title.errors %}
            <p class="text-red-500 text-sm mt-1">{{ form.title.errors.0 }}</p>
          {% endif %}
        </div>
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-2">Subtitle</label>
          {{ form.subtitle }}
          {% if form.subtitle.errors %}
            <p class="text-red-500 text-sm mt-1">{{ form.subtitle.errors.0 }}</p>
          {% endif %}
        </div>
      </div>
      <div class="flex items-center gap-4">
        <label class="flex items-center gap-2">
          {{ form.is_active }}
          <span class="text-sm text-slate-700">Active</span>
        </label>
      </div>
      
      <!-- Non-field errors -->
      {% if form.non_field_errors %}
        <div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg">
          {% for error in form.non_field_errors %}
            <p>{{ error }}</p>
          {% endfor %}
        </div>
      {% endif %}
      
      <div class="flex gap-3">
        <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Create Page Hero</button>
        <button type="button" onclick="document.getElementById('createForm').classList.add('hidden')" class="px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300">Cancel</button>
      </div>
    </form>
  </div>

  <script>
    // Auto-hide form after successful submission
    {% if success_message %}
      document.getElementById('createForm').classList.add('hidden');
    {% endif %}
    
    // Form submission handler
    document.querySelector('#createForm form').addEventListener('submit', function() {
      // Show loading state
      const submitBtn = this.querySelector('button[type="submit"]');
      submitBtn.disabled = true;
      submitBtn.innerHTML = '<i class="ri-loader-4-line animate-spin"></i> Creating...';
    });
  </script>

  <!-- Page Heroes Grid -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
    {% for hero in items %}
    <div class="bg-white rounded-xl border border-slate-200 overflow-hidden">
      {% if hero.image %}
      <div class="h-32 bg-slate-100 flex items-center justify-center">
        <img src="{{ hero.image.url }}" alt="{{ hero.title|default:hero.get_page_display }}" class="h-full w-full object-cover">
      </div>
      {% else %}
      <div class="h-32 bg-slate-100 flex items-center justify-center text-slate-400">
        <i class="ri-image-line text-3xl"></i>
      </div>
      {% endif %}
      
      <div class="p-4">
        <div class="flex items-center justify-between mb-2">
          <h3 class="font-medium text-slate-800">{{ hero.get_page_display }}</h3>
          {% if hero.is_active %}
            <span class="px-2 py-1 text-xs bg-green-100 text-green-700 rounded-full">Active</span>
          {% else %}
            <span class="px-2 py-1 text-xs bg-red-100 text-red-700 rounded-full">Inactive</span>
          {% endif %}
        </div>
        
        {% if hero.title %}
        <p class="text-sm text-slate-600 mb-1">{{ hero.title }}</p>
        {% endif %}
        
        {% if hero.subtitle %}
        <p class="text-xs text-slate-500 mb-3">{{ hero.subtitle }}</p>
        {% endif %}
        
        <div class="flex items-center gap-2">
          <a href="{% url 'panel_page_hero_edit' hero.id %}" class="text-sm text-blue-600 hover:text-blue-800">Edit</a>
          <span class="text-slate-300">|</span>
          <form method="POST" action="{% url 'panel_page_hero_delete' hero.id %}" class="inline" onsubmit="return confirm('Are you sure you want to delete this page hero?')">
            {% csrf_token %}
            <button type="submit" class="text-sm text-red-600 hover:text-red-800">Delete</button>
          </form>
        </div>
      </div>
    </div>
    {% empty %}
    <div class="col-span-full text-center py-12 text-slate-500">
      <div class="text-4xl mb-4">ðŸ“·</div>
      <p class="text-lg mb-2">No page hero images yet</p>
      <p class="text-sm">Create your first page hero to get started</p>
    </div>
    {% endfor %}
  </div>
</div>
{% endblock %}
