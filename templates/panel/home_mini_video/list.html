{% extends 'panel/base.html' %}
{% block title %}Home Mini Video{% endblock %}
{% block nav_home_mini_video %}bg-blue-50 text-blue-600{% endblock %}
{% block content %}
<div class="flex items-center justify-between mb-4">
  <h1 class="text-xl font-semibold text-slate-800">Home Mini Video</h1>
  <button onclick="document.getElementById('hmvModal').classList.remove('hidden')" class="px-3 py-2 rounded-lg bg-blue-600 text-white shadow-sm">New Mini Video</button>
  <div id="hmvModal" class="hidden fixed inset-0 bg-black/40 flex items-center justify-center">
    <div class="bg-white rounded-xl w-[92%] max-w-lg p-5">
      <div class="flex items-center justify-between mb-3">
        <h3 class="font-semibold">Create Home Mini Video</h3>
        <button onclick="this.closest('#hmvModal').classList.add('hidden')"><i class="ri-close-line"></i></button>
      </div>
      <form method="post" enctype="multipart/form-data" action="{% url 'panel_home_mini_video_create' %}" class="space-y-3">
        {% csrf_token %}
        {{ form.as_p }}
        <div class="flex justify-end gap-2">
          <button type="button" onclick="document.getElementById('hmvModal').classList.add('hidden')" class="px-3 py-2 rounded-lg border">Cancel</button>
          <button class="px-3 py-2 rounded-lg bg-blue-600 text-white">Create</button>
        </div>
      </form>
    </div>
  </div>
</div>

<div class="bg-white border border-slate-200 rounded-xl overflow-hidden shadow-sm">
  <div class="p-3 border-b border-slate-200 flex items-center gap-2">
    <div class="text-slate-600 text-sm">Total: {{ items|length }}</div>
  </div>
  <table class="min-w-full text-sm">
    <thead class="bg-slate-50">
      <tr class="text-left text-slate-500">
        <th class="p-3">Type</th>
        <th class="p-3">Source</th>
        <th class="p-3">Status</th>
        <th class="p-3">Settings</th>
        <th class="p-3 w-40"></th>
      </tr>
    </thead>
    <tbody class="divide-y divide-slate-100">
      {% for item in items %}
      <tr>
        <td class="p-3">
          {% if item.video_file %}
            <span class="inline-flex items-center gap-1 text-blue-600"><i class="ri-video-line"></i> File</span>
          {% elif item.youtube_url %}
            <span class="inline-flex items-center gap-1 text-red-600"><i class="ri-youtube-line"></i> YouTube</span>
          {% endif %}
        </td>
        <td class="p-3 text-slate-500">
          {% if item.video_file %}
            {{ item.video_file.name|truncatechars:30 }}
          {% elif item.youtube_url %}
            {{ item.youtube_url|truncatechars:30 }}
          {% endif %}
        </td>
        <td class="p-3">
          {% if item.is_active %}
            <span class="inline-flex items-center gap-1 text-green-600"><i class="ri-check-circle-fill"></i> Active</span>
          {% else %}
            <span class="inline-flex items-center gap-1 text-slate-400"><i class="ri-close-circle-fill"></i> Inactive</span>
          {% endif %}
        </td>
        <td class="p-3 text-slate-500">
          {% if item.autoplay %}<span class="text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded">Autoplay</span>{% endif %}
          {% if item.muted %}<span class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded">Muted</span>{% endif %}
        </td>
        <td class="p-3 text-right">
          <a class="px-2 py-1 text-blue-700" href="{% url 'panel_home_mini_video_edit' item.pk %}">Edit</a>
          <form method="post" action="{% url 'panel_home_mini_video_delete' item.pk %}" class="inline">{% csrf_token %}
            <button class="px-2 py-1 text-red-600" onclick="return confirm('Delete this mini video?')">Delete</button>
          </form>
        </td>
      </tr>
      {% empty %}
      <tr><td class="p-3 text-slate-500" colspan="5">No mini videos yet.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
