{% extends 'panel/base.html' %}
{% block title %}Destinations{% endblock %}
{% block nav_destinations %}bg-blue-50 text-blue-600{% endblock %}
{% block content %}
<div class="flex items-center justify-between mb-4">
  <h1 class="text-xl font-semibold text-slate-800">Destinations</h1>
  <button onclick="document.getElementById('dstModal').classList.remove('hidden')" class="px-3 py-2 rounded-lg bg-blue-600 text-white shadow-sm">New Destination</button>
  <div id="dstModal" class="hidden fixed inset-0 bg-black/40 flex items-center justify-center">
    <div class="bg-white rounded-xl w-[92%] max-w-lg p-5">
      <div class="flex items-center justify-between mb-3">
        <h3 class="font-semibold">Create Destination</h3>
        <button onclick="this.closest('#dstModal').classList.add('hidden')"><i class="ri-close-line"></i></button>
      </div>
      <form method="post" enctype="multipart/form-data" action="{% url 'panel_destination_create' %}" class="space-y-3">
        {% csrf_token %}
        {{ form.as_p }}
        <div class="flex justify-end gap-2">
          <button type="button" onclick="document.getElementById('dstModal').classList.add('hidden')" class="px-3 py-2 rounded-lg border">Cancel</button>
          <button class="px-3 py-2 rounded-lg bg-blue-600 text-white">Create</button>
        </div>
      </form>
    </div>
  </div>
</div>

<div class="bg-white border border-slate-200 rounded-xl overflow-hidden shadow-sm">
  <div class="p-3 border-b border-slate-200 flex items-center gap-2">
    <div class="text-slate-600 text-sm">Total: {{ items|length }}</div>
  </div>
  <table class="min-w-full text-sm">
    <thead class="bg-slate-50">
      <tr class="text-left text-slate-500">
        <th class="p-3">Title</th>
        <th class="p-3">Description</th>
        <th class="p-3">Hero</th>
        <th class="p-3">Video</th>
        <th class="p-3 w-40"></th>
      </tr>
    </thead>
    <tbody class="divide-y divide-slate-100">
      {% for d in items %}
      <tr>
        <td class="p-3">{{ d.title }}</td>
        <td class="p-3 text-slate-500">{{ d.description|truncatewords:18 }}</td>
        <td class="p-3">{% if d.hero_image %}<img src="{{ d.hero_image.url }}" class="w-16 h-10 object-cover rounded" />{% else %}<span class="text-slate-400">—</span>{% endif %}</td>
        <td class="p-3">{% if d.mini_video %}<span class="inline-flex items-center gap-1 text-green-600"><i class="ri-play-circle-fill"></i> video</span>{% else %}<span class="text-slate-400">—</span>{% endif %}</td>
        <td class="p-3 text-right">
          <a class="px-2 py-1 text-blue-700" href="{% url 'panel_destination_edit' d.pk %}">Edit</a>
          <form method="post" action="{% url 'panel_destination_delete' d.pk %}" class="inline">{% csrf_token %}
            <button class="px-2 py-1 text-red-600" onclick="return confirm('Delete this destination?')">Delete</button>
          </form>
        </td>
      </tr>
      {% empty %}
      <tr><td class="p-3 text-slate-500" colspan="3">No destinations yet.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}


